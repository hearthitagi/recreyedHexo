---
title: 顺序异步与并行异步技巧
date: 2023-04-20 17:38:21
updated:
tags:
  - javaScript
categories:
  - 前端知识
keywords:
description:
  关于异步请求的一些逻辑处理记录
top_img:
comments:
cover: https://img.recreyed.tk/1681983698321.webp
toc:
toc_number:
toc_style_simple:
copyright:
copyright_author:
copyright_author_href:
copyright_url:
copyright_info:
mathjax:
katex:
aplayer:
highlight_shrink:
aside:
---
## 1、异步操作顺序执行
```javascript
const uploadArray = () => {
    fileList.value.reduce((previousValue, currentValue) => {
        return previousValue.then(() => {
            return upload(currentValue)
        }).catch(() => {
            return upload(currentValue)
        })
    }, Promise.resolve())
}
```
```javascript
const upload = (fileItem) => {
    return new Promise((resolve, reject) => {
        // 异步操作（接口等）
        uploadFile(fileItem).then((res: any) => {
            if (res.state == 200) {
                resolve()
            } else {
                reject()
            }
        })
    })
}
```
`reduce()`方法对数组中的每个元素按序执行一个的回调函数，每一次运行回调函数会将先前元素的计算结果作为参数传入
详细参考[Array.prototype.reduce()](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce)  
## 2、并行执行完所有异步操作后，再继续其他内容
```javascript
const delPic = (file) => {
    return new Promise((resolve, reject) => {
        s3DelImg({ fileName: file.fileName, fileId: file.fileId}).then((res: any) => {
            if (res.state == 200) {
            } else {
                message.error(res.message)
            }
            resolve()
        })
    })
};
```
```javascript
const delList = () => {
    let delList = [1,2,3]
    let proResList = delList.map((item: any) => { return delPic(item) })
    Promise.all(proResList).then(() => {
        getImgList()
    })
}
```
`Promise.all()`,对传入的promise组成的数组进行检测，数组中promise全部成功resolve()后,`.then()`执行后续操作
